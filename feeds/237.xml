<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title type="text">item4 Dev Story</title>
  <id>urn:uuid:944b0bd9-f020-38de-9f40-e2162b041b61</id>
  <updated>2019-02-03T13:42:00+09:00</updated>
  <link href="https://item4.github.io/" />
  <link href="https://item4.github.io/feed.xml" rel="self" />
  <author>
    <name></name>
  </author>
  <generator uri="https://github.com/ajdavis/lektor-atom" version="0.2">Lektor Atom Plugin</generator>
  <entry xml:base="https://item4.github.io/2019-02-03/Setting-Python-Environment-with-pyenv-virtualenvwrapper/">
    <title type="text">pyenv-virtualenvwrapper로 Python 개발 환경 세팅하기</title>
    <id>urn:uuid:be7422b2-1e43-35ce-9662-01259b26f5eb</id>
    <updated>2019-02-03T13:42:00+09:00</updated>
    <link href="https://item4.github.io/2019-02-03/Setting-Python-Environment-with-pyenv-virtualenvwrapper/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;h2&gt;고통의 Python 개발환경&lt;/h2&gt;
&lt;p&gt;Python으로 개발을 할 때, 자신의 개발환경에서 단 하나의 프로젝트만 개발한다면 별 문제가 없지만 여러 프로젝트를 진행하게 되면 애로사항이 만개합니다.
예를 들어 어느 프로젝트는 django 버전 1.11을 사용하지만 다른 프로젝트에서 2 이상을 사용한다면 의존성 버전 문제가 발생합니다.
Python은 기본적으로 하나의 의존성에 대해 한 가지 버전만 설치가 가능하기 때문입니다.
이 문제로 많은 Python 개발자들이 고통을 받아왔고, 아직도 고통받고 있습니다.
이것에 대해 많은 질문을 받아왔고, 이 글을 통해 보고서 따라할 수 있는 가이드를 작성해보기로 했습니다.&lt;/p&gt;
&lt;h2&gt;설명에 앞서서&lt;/h2&gt;
&lt;p&gt;본 가이드의 접근법은 Windows에선 사용할 수 없습니다.
전략의 핵심인 pyenv가 Windows를 지원하지 않기 때문입니다.&lt;/p&gt;
&lt;h2&gt;virtualenv와 virtualenvwrapper&lt;/h2&gt;
&lt;p&gt;위에서도 언급했지만 Python은 기본적으로 하나의 의존성에 대해 한 가지 버전만 설치가 가능합니다.
여러 프로젝트를 진행하기 위해 Python 진영에서는 virtualenv라는 툴을 사용합니다.
하지만 virtualenv는 기본적으로 사용법도 불편하고, virtualenv 관련으로 생성되는 수많은 디렉토리가 프로젝트마다 생기므로 관리가 성가십니다.
이러한 문제의 해소를 위해 virtualenvwrapper가 등장합니다.
virtualenv 관련 디렉토리를 한 곳에 몰아서 관리해주고, activate 등의 작업을 보다 편하게 할 수 있도록 도와줍니다.&lt;/p&gt;
&lt;h2&gt;pyenv&lt;/h2&gt;
&lt;p&gt;virtualenv는 프로젝트마다 의존성을 분리하게 하는데엔 성공했지만 Python 버전 자체가 여러가지 필요한 경우를 커버하지 못합니다.
Python 버전을 여러가지 설치하면 Python 실행이 여러모로 지저분해집니다.
이 문제의 해결을 위해 pyenv가 등장했습니다.
Python을 여러 버전을 설치할 수 있도록 도와주고, 현재 사용할 Python 버전을 정할 수 있게 해줍니다.&lt;/p&gt;
&lt;h2&gt;pyenv-virtualenvwrapper&lt;/h2&gt;
&lt;p&gt;pyenv와 virtualenvwrapper는 둘 다 Python 개발자에게 필요한 도구였기에 둘을 합친 확장이 등장합니다.
pyenv를 통해 Python 버전을 설치하고 virtualenvwrapper를 통해 virtualenv를 관리합니다.&lt;/p&gt;
&lt;h2&gt;실제로 세팅하기&lt;/h2&gt;
&lt;h3&gt;1. pyenv 설치&lt;/h3&gt;
&lt;p&gt;가장 먼저 pyenv를 설치해야합니다.&lt;/p&gt;
&lt;h4&gt;Linux&lt;/h4&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ curl https://pyenv.run &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; bash
&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;macOS&lt;/h4&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ brew install pyenv
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;2. Shell 세팅&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;.bash_profile&lt;/code&gt;에 pyenv를 세팅해야합니다.
(OS와 Shell 종류에 따라 파일명이 &lt;code&gt;.zshenv&lt;/code&gt;, &lt;code&gt;.bashrc&lt;/code&gt;로 다를 수 있습니다.)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;.bash_profile&lt;/code&gt;을 열어서 맨 아래에 다음 내용을 추가해주세요.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;PYENV_ROOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$HOME&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/.pyenv&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PYENV_ROOT&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/bin:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PATH&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt; -v pyenv &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&amp;gt;/dev/null &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&amp;gt;&lt;span class=&quot;p&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;pyenv init -&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;저장한 뒤에 다음 명령어로 Shell을 재실행하면 pyenv를 사용할 수 있게 됩니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SHELL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;3. Python 설치&lt;/h3&gt;
&lt;p&gt;virtualenv와 virtualenvwrapper는 Python이 있어야 설치할 수 있습니다.
다음 명령어로 Python을 설치해주세요.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ pyenv install &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;.7.2
$ pyenv global &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;.7.2
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;4. pyenv-virtualenvwrapper 설치&lt;/h3&gt;
&lt;p&gt;pyenv-virtualenvwrapper는 pyenv의 플러그인입니다.
다음 방법으로 설치할 수 있습니다.&lt;/p&gt;
&lt;h4&gt;Linux&lt;/h4&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git clone https://github.com/pyenv/pyenv-virtualenvwrapper.git &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;pyenv root&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;/plugins/pyenv-virtualenvwrapper
&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;macOS&lt;/h4&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ brew install pyenv-virtualenvwrapper
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;5. (또) Shell 세팅&lt;/h3&gt;
&lt;p&gt;이번엔 &lt;code&gt;.bash_profile&lt;/code&gt;에 pyenv-virtualenvwrapper를 세팅해야합니다.
(OS와 Shell 종류에 따라 파일명이 &lt;code&gt;.zshenv&lt;/code&gt;, &lt;code&gt;.bashrc&lt;/code&gt;로 다를 수 있습니다.)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;.bash_profile&lt;/code&gt;을 열어서 아까 추가한 소스 코드 아래로 다음 내용을 추가해주세요.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pyenv virtualenvwrapper_lazy
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;저장한 뒤에 다음 명령어로 Shell을 재실행하면 pyenv-virtualenvwrapper를 사용할 수 있게 됩니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SHELL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;개발 환경 사용법&lt;/h2&gt;
&lt;h3&gt;Python 버전 설치&lt;/h3&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ pyenv install &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;version&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;현재 설치된 Python 버전 목록&lt;/h3&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ pyenv versions
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;전역 Python 버전 변경&lt;/h3&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ pyenv global &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;version&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;프로젝트를 위해 virtualenv 생성&lt;/h3&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ mkvirtualenv &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;project name&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;virtualenv 활성화&lt;/h3&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ workon &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;project name&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;virtualenv 비활성화&lt;/h3&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ deactivate
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;현재 디렉토리를 프로젝트의 Home 디렉토리로 설정하기&lt;/h3&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ setvirtualenvproject
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;virtualenv 삭제&lt;/h3&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ rmvirtualenv &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;project name&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;virtualenv 목록&lt;/h3&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ lsvirtualenv
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;에디터/IDE와의 연동&lt;/h2&gt;
&lt;h3&gt;Visual Studio Code&lt;/h3&gt;
&lt;p&gt;기본적으로 VSCode에 Python 플러그인이 설치되어 있어야 합니다.&lt;/p&gt;
&lt;p&gt;먼저 다음 명령어로 Python 바이너리의 위치를 찾습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ workon &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;project name&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
$ which python
/Users/item4/.virtualenvs/blog/bin/python
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그 다음, VSCode에서 명령 팔레트를 열고 &lt;code&gt;Python: Select Interpreter&lt;/code&gt; 라고 입력한 후 Ender를 눌러주세요&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2019-02-03/Setting-Python-Environment-with-pyenv-virtualenvwrapper/vscode-command-palette.png&quot; alt=&quot;VSCode 명령 팔레트&quot;&gt;&lt;/p&gt;
&lt;p&gt;나타난 입력칸에 아까 찾은 경로를 입력하면 세팅 완료입니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2019-02-03/Setting-Python-Environment-with-pyenv-virtualenvwrapper/vscode-select-python-interpreter.png&quot; alt=&quot;VSCode에서 interpreter 선택하기&quot;&gt;&lt;/p&gt;
&lt;h3&gt;PyCharm&lt;/h3&gt;
&lt;p&gt;먼저 다음 명령어로 Python 바이너리의 위치를 찾습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ workon &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;project name&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
$ which python
/Users/item4/.virtualenvs/blog/bin/python
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그 다음 PyCharm에서 프로젝트를 생성한 후 Preferences 창을 열어주세요.
좌측 메뉴에 &lt;code&gt;Project: [name]&lt;/code&gt;이 있고, 확장하면 &lt;code&gt;Python Interpreter&lt;/code&gt; 메뉴가 나옵니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2019-02-03/Setting-Python-Environment-with-pyenv-virtualenvwrapper/pycharm-preferences-menu.png&quot; alt=&quot;PyCharm Preferences 메뉴&quot;&gt;&lt;/p&gt;
&lt;p&gt;해당 메뉴에 들어가면 우측 상단에 톱니바퀴 버튼이 있는데, 눌러서 Add 버튼을 눌러주세요.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2019-02-03/Setting-Python-Environment-with-pyenv-virtualenvwrapper/pycharm-select-python-interpreter.png&quot; alt=&quot;PyCharm interpreter 선택 인터페이스&quot;&gt;&lt;/p&gt;
&lt;p&gt;Virtuanenv Environment 메뉴에서 Existing environment를 선택하고 경로 선택창에서 아까 찾은 경로를 선택해주세요.
OK버튼을 누르면 PyCharm에서 해당 virtualenv를 선택할 수 있게 되므로 선택하면 그때부터 연동됩니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2019-02-03/Setting-Python-Environment-with-pyenv-virtualenvwrapper/pycharm-add-python-interpreter.png&quot; alt=&quot;PyCharm에서 virtualenv 선택하기&quot;&gt;&lt;/p&gt;
</content>
  </entry>
  <entry xml:base="https://item4.github.io/2019-01-13/Make-2019-New-Years-Resolution/">
    <title type="text">2019년 새해 목표 정하기</title>
    <id>urn:uuid:e0b4757e-5cbc-302a-956c-8407fa50b134</id>
    <updated>2019-01-13T14:32:00+09:00</updated>
    <link href="https://item4.github.io/2019-01-13/Make-2019-New-Years-Resolution/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;h2&gt;신년 목표 없는 삶&lt;/h2&gt;
&lt;p&gt;연도가 바뀌었습니다.
세는 나이&lt;sup class=&quot;footnote-ref&quot; id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;도 1살 늘었고, 몇 달 뒤면 연호가 바뀌는 국가&lt;sup class=&quot;footnote-ref&quot; id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;도 있습니다.
다들 새해라고 무언가 목표를 잡는 분위기였는데 저는 예로부터 신년목표를 잡지 않았습니다.
이유는 간단합니다.
단 한 번도 성공하지 못했거든요.
그래서 남들이 신년이라고 분주할 때 저는 평소와 같은 삶을 살았습니다.
주변 환경의 변화에 따라 자신이 변하긴 했지만 제가 정한 목표로 무언가 하진 않았습니다.
목표가 저를 옭아매는 상황은 피하고 싶었기 때문이죠.&lt;/p&gt;
&lt;h2&gt;2019년&lt;/h2&gt;
&lt;p&gt;그런데 올해는 무언가 해보고 싶은 것이 생겼습니다.
나이를 먹어가는 두려움 때문인건지 어떤건지는 모르겠지만 무언가 목표를 정해보면 어떨까 하는 생각에 몸이 근질거립니다.
그래서 고민해봤습니다.
어떻게 해야 유의미하고, 스스로에게 부담이 안 되면서, 지속 가능한 신년 목표를 설정할 수 있을지요.&lt;/p&gt;
&lt;h2&gt;티끌 모아 태산&lt;/h2&gt;
&lt;p&gt;제가 선택한 방법은 다음과 같습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;너무나 자잘하고 사소해서 달성하지 못 하는게 힘들만한 일들, 약간 수고로움을 겪어야 하는 일 등등을 정리합니다.&lt;/li&gt;
&lt;li&gt;자잘한 목표들에게 저 나름대로의 가중치를 매깁니다.&lt;/li&gt;
&lt;li&gt;2019년 연말까지 부담감 없이 평소처럼 살아갑니다. (목표달성에 얽메이지 않는 것이 중요)&lt;/li&gt;
&lt;li&gt;연말이 되면 일단 기존 가중치를 기준으로 점수를 환산해봅니다.&lt;/li&gt;
&lt;li&gt;연말 시점에서 느끼는 가중치를 새로 책정해보고, 연초에 책정했던것과 얼마나 다른지 비교합니다.&lt;/li&gt;
&lt;li&gt;그렇게하면 자연스럽게 내년 목표로 이어질 것으로 전망하고 있습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 방법이 과연 유효할지는 직접 1년간 겪어봐야 알 것 같습니다.&lt;/p&gt;
&lt;h2&gt;그렇게 정해진 목표&lt;/h2&gt;
&lt;h3&gt;1점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;취미 생활을 위한 무언가를 사기 위해 2500원을 쓸때마다 (책, 음반 등등)&lt;/li&gt;
&lt;li&gt;아침약을 빼먹지 않고 먹은 날마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;2점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;전공 공부를 위한 책을 한 권 살때마다&lt;/li&gt;
&lt;li&gt;페미니즘을 다루는 책을 한 권 살때마다&lt;/li&gt;
&lt;li&gt;취침 전 약을 빼먹지 않고 먹은 날마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;3점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;사놓고 읽지 못한 만화책을 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;책상을 정리할때마다 (하루 최대 1번)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;4점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;사놓고 읽지 못한 라이트노벨/소설을 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;일본어로 된 트윗(트위터 글)을 번역기 없이 내용을 이해하는데 성공할때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;5점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;올해들어 새로 산 만화책을 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;소드 아트 온라인 관련 도서/문서를 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;자다가 깨어나면 다시 잠들지 않는데에 성공할때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;6점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;올해들어 새로 산 라이트노벨/소설을 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;사놓고 읽지 못했던 책들 중에 흥미가 떨어진 책을 가볍게 훑어보는 식으로 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;모르는 외국어 단어를 무시하지 않고 사전에 검색해볼때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;7점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;올해들어 새로 산 일반 도서를 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;사놓고 읽지 못했던 책들 중에 전공과 무관한 책을 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;26시(익일 2시) 이전에 잠자리에 들어간 날마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;8점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;페미니즘 관련 도서를 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;성 소수자 인권 관련 도서를 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;예전에 블로그에 썼던 글을 하나 보강할때마다&lt;/li&gt;
&lt;li&gt;YUI 코드를 개선할때마다 (하루 최대 1번)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;9점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;페미니즘에 관련된 영상자료를 하나 시청할때마다&lt;/li&gt;
&lt;li&gt;성 소수자 인권에 관련된 영상자료를 하나 시청할때마다&lt;/li&gt;
&lt;li&gt;24시(익일 0시) 이후로는 물 외의 것을 먹지 않는데에 성공한 날마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;10점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;블로그에 짧은 글을 쓸때마다&lt;/li&gt;
&lt;li&gt;오픈소스 프로젝트에 간단한(오타 수정) 기여할때마다&lt;/li&gt;
&lt;li&gt;읽었던 책을 처음부터 끝까지 다시 읽을때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;15점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;사놓고 읽지 못했던 전공서를 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;YUI에 간단한 신기능을 추가할때마다&lt;/li&gt;
&lt;li&gt;내게 무례한 사람이 신경쓰일때 생각을 돌리려고 노력해서 스트레스를 줄이는 데에 성공할때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;20점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;(연간목표) YUI test coverage 65% 돌파&lt;/li&gt;
&lt;li&gt;올해들어 새로 산 전공서를 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;선물 받았지만 마저 읽지 못했던 책들을 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;PyJog에 참석할때마다&lt;/li&gt;
&lt;li&gt;사용법을 익히려는 하는 Python 라이브러리의 코드를 읽을때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;40점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;(연간목표) YUI test coverage 70% 돌파&lt;/li&gt;
&lt;li&gt;블로그에 글을 쓸때마다 (짧은 글 제외)&lt;/li&gt;
&lt;li&gt;새로 익힌 언어/프레임워크/라이브러리로 간단한 프로젝트를 만들어볼때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;60점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;(연간목표) YUI test coverage 75% 돌파&lt;/li&gt;
&lt;li&gt;새로운 프로그래밍 언어를 간단한 Web-crawler를 작성할 정도로 학습할때마다&lt;/li&gt;
&lt;li&gt;한국어가 아닌 다른 언어로 된 도서를 한 권 읽을때마다&lt;/li&gt;
&lt;li&gt;YUI에 복잡한 기능을 추가할때마다 (계류중인 calc 재구현 같은 것들)&lt;/li&gt;
&lt;li&gt;방치했던 프로젝트를 개선하여 사용 가능한 물건으로 만족할 만큼 고치는데에 성공할때마다&lt;/li&gt;
&lt;li&gt;Python의 asyncio의 보다 깊은 부분을 학습하려고 자료를 찾아 학습할때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;80점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;(연간목표) YUI test coverage 80% 돌파&lt;/li&gt;
&lt;li&gt;오픈소스 프로젝트에 기여할때마다 (간단한 기여 제외)&lt;/li&gt;
&lt;li&gt;외국 블로그의 맘에 드는 글을 번역해서 블로그에 올릴때마다&lt;/li&gt;
&lt;li&gt;새로 익힌 언어/프레임워크/라이브러리로 실용적인 프로젝트를 만들때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;100점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;(연간목표) 휴학 연장에 성공&lt;/li&gt;
&lt;li&gt;(연간목표) TypeScript 공식 문서를 읽고 모르고 넘기는 부분이 마음에 걸리지 않을 정도로 이해한다&lt;/li&gt;
&lt;li&gt;(연간목표) React 문서를 읽고 모르고 넘기는 부분이 마음에 걸리지 않을 정도로 이해한다&lt;/li&gt;
&lt;li&gt;(연간목표) Vue 문서를 읽고 모르고 넘기는 부분이 마음에 걸리지 않을 정도로 이해한다&lt;/li&gt;
&lt;li&gt;(연간목표) Rust 문서를 읽고 모르고 넘기는 부분이 마음에 걸리지 않을 정도로 이해한다&lt;/li&gt;
&lt;li&gt;사용법을 익히려는 하는 (Python이 아닌 언어의) 라이브러리의 코드를 읽어볼때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;125점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;컨퍼런스에 참가할때마다&lt;/li&gt;
&lt;li&gt;(연간목표) 이력서 페이지를 다른 정적 사이트 생성기로 변경한다&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://item4.net&quot;&gt;item4.net&lt;/a&gt;에 새로운 API를 개발해서 서비스할때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;200점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;(연간목표) 블로그를 다른 정적 사이트 생성기로 변경한다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;-1점 (감점)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;넥슨사의 온라인게임 &lt;클로저스&gt; 플레이에 1분을 소모할때마다&lt;/li&gt;
&lt;li&gt;넥슨사의 온라인게임 &lt;클로저스&gt;에 1000원 과금할때마다&lt;/li&gt;
&lt;li&gt;반다이남코의 모바일게임 &amp;lt;소드 아트 온라인 -메모리 디프래그-&amp;gt;에 1000원 과금할때마다&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;예시&lt;/h2&gt;
&lt;h3&gt;사례1&lt;/h3&gt;
&lt;p&gt;좋아하는 애니메이션 관련 상품을 구입하는데에 25000원을 사용하면 &lt;code&gt;25000/2500 = 10&lt;/code&gt;점이 오릅니다.&lt;/p&gt;
&lt;h3&gt;사례2&lt;/h3&gt;
&lt;p&gt;YUI에 CALC 기능을 리팩토링 하는데에 성공하면 &lt;code&gt;60&lt;/code&gt;점이 오릅니다.
그 과정에서 다른 Python 오픈소스를 2개 참조한다면 추가로 &lt;code&gt;20 * 2 = 40&lt;/code&gt;점이 오릅니다.&lt;/p&gt;
&lt;h3&gt;사례3&lt;/h3&gt;
&lt;p&gt;새로익힌 기술로 간단한 프로젝트를 만들어보고 그 과정을 블로깅하면 &lt;code&gt;40+40 = 80&lt;/code&gt;점이 오릅니다.&lt;/p&gt;
&lt;h3&gt;사례4&lt;/h3&gt;
&lt;p&gt;작년에 구입한 소드 아트 온라인 21권 일본어 원서를 읽을 경우 &lt;code&gt;4+5+60 = 69&lt;/code&gt;점이 오릅니다.
이 과정에서 모르는 일본어 단어를 검색해볼때마다 &lt;code&gt;6&lt;/code&gt;점씩 추가됩니다.&lt;/p&gt;
&lt;h3&gt;사례5&lt;/h3&gt;
&lt;p&gt;한참 전에 구입한 4월은 너의 거짓말 소설외전 일본어 원서를 읽을 경우 &lt;code&gt;4+60 = 69&lt;/code&gt;점이 오릅니다.
이 과정에서 모르는 일본어 단어를 검색해볼때마다 &lt;code&gt;6&lt;/code&gt;점씩 추가됩니다.&lt;/p&gt;
&lt;h3&gt;사례6&lt;/h3&gt;
&lt;p&gt;올해 말 기준으로 YUI의 테스트 커버리지가 81%라면 &lt;code&gt;20+40+60+80 = 200&lt;/code&gt;점이 오릅니다.&lt;/p&gt;
&lt;h3&gt;사례7&lt;/h3&gt;
&lt;p&gt;올해 메디프(소드 아트 온라인 -메모리 디프래그-)에 10만원을 사용한다면 &lt;code&gt;100000/1000 * 1 = 100&lt;/code&gt;점이 감점됩니다.&lt;/p&gt;
&lt;h2&gt;무엇을 위한 목표인가?&lt;/h2&gt;
&lt;p&gt;제가 살면서 해야할 일 내지는 하고 싶은 일을 목록화하고, 그것을 게이미피케이션(Gamification)해보았습니다.
점수 형태이므로 재미(?)도 있고, 점수로 월별/분기별 그래프를 내서 무슨 일이 있었는지 역추적도 가능합니다.
점수라고 하면 평가기준으로 생각되기 쉽지만 저는 몇 점 이상을 내야 이상적인 삶이라던가, 몇 점 이하면 나태한 삶이었다 같은 평가는 내지 않으려고 합니다.
대신 연초에 생각한 점수 모델과, 연말에 다시 보는 점수 모델을 비교해서 저는 어떻게 변했고, 어떻게 살아왔는지를 돌아보고 싶을 뿐입니다.
제 삶의 시계는 오직 저만을 위해 정해진 속도로 흐르고, 다른 사람과 비교할 필요가 없으니까요.&lt;/p&gt;
&lt;h2&gt;별첨: 페미니즘 / 성 소수자 인권 관련 목표에 대하여&lt;/h2&gt;
&lt;p&gt;어떤 사람은 왜 저런 목표가 섞여있냐고 하실지도 모르겠습니다.
제 의견은 간단합니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&quot;아직 잘 모르니까 더 배워야죠&quot;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;'저런거 몰라도 사는 데에 지장이 없다고 생각하는 것' 자체가 이미 권력입니다.
이와 관련해서 강연 한 편, 책 한 권 조차 읽어보지 않은 분들이 '지능의 문제, 빨리 탈출해야' 같은 소리를 하면 저는 정말 기분이 나쁩니다.&lt;/p&gt;
&lt;p&gt;왜냐구요?&lt;/p&gt;
&lt;p&gt;저렇게 말하는 사람이 저를 뒤에서 어떻게 말하겠습니까?
페미니스트와 성 소수자분들조차 이해해주지 못하는 분이 제 입장을 이해해줄 수 있을거라 생각하지 않습니다.&lt;/p&gt;
&lt;h2&gt;도중 수정 내역&lt;/h2&gt;
&lt;p&gt;메모리 디프래그 관련 커뮤니티 활동을 하게 되어 게임을 하지 않는다는 목표를 과금시 감점 규칙으로 변경했습니다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;&lt;li id=&quot;fn-1&quot;&gt;&lt;p&gt;한국식 나이&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;&lt;p&gt;일본&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</content>
  </entry>
  <entry xml:base="https://item4.github.io/2018-11-04/Extract-Python-Code-from-PyInstaller-EXE-File/">
    <title type="text">PyInstaller로 만든 EXE 파일에서 Python code 뽑아내기</title>
    <id>urn:uuid:1da433a4-d6bf-3ca2-847a-7496a1ab9826</id>
    <updated>2018-11-04T23:33:00+09:00</updated>
    <link href="https://item4.github.io/2018-11-04/Extract-Python-Code-from-PyInstaller-EXE-File/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;h2&gt;스펙지수 계산기&lt;/h2&gt;
&lt;p&gt;저는 몇 달 전부터 방치형 모바일 게임을 하나 하고 있습니다.
그 게임에선 유저들 사이에서 &quot;님 스펙 몇?&quot; 같은 방식으로 사용되는 &quot;스펙지수&quot;라는 수치가 존재합니다.
자신의 유닛들의 몇몇 수치를 입력하면 자신의 투자효율을 계산해주는 것이죠.
그런데 모두가 사용하는 계산기는 EXE로 되어있어서 맥 유저인 저는 써볼 수가 없었습니다.
그래서 EXE 파일 내에 있는 공식을 어떻게 뜯어낼 수 없을까 하는 생각이 들었습니다.&lt;/p&gt;
&lt;h2&gt;너의 정체는.&lt;/h2&gt;
&lt;p&gt;일단 가장 먼저 해본 것은 이 파일이 C#으로 작성되었다고 가정하는 것이었습니다.
이유는 단순, C#으로 작성된 EXE는 Visual Studio에 던져넣는것 만으로도 코드를 볼 수 있기 때문입니다.
하지만 Visual Studio님은 EXE를 던져넣자 응답없음 상태가 되셨죠.&lt;/p&gt;
&lt;p&gt;적어도 C#은 아닌 것 같아서 다른 분석툴을 찾다가 Hopper Disassembler를 알게 되었습니다.
이 프로그램은 상용 프로그램이지만 데모 버전으로도 EXE를 풀 수 있는지 정도는 알 수 있을테고, 간단히 훑어보고 어려워보이면 바로 포기할 생각이었죠.
그래서 일단 열어보았습니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2018-11-04/Extract-Python-Code-from-PyInstaller-EXE-File/hopper.png&quot; alt=&quot;Hopper Disassembler가 보여주는 Symbol들&quot;&gt;&lt;/p&gt;
&lt;p&gt;코드를 읽을 순 없었지만 뭔가 친근한 단어들이 보입니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;이거 혹시 Python 코드인가?&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;뜯어보자!&lt;/h2&gt;
&lt;p&gt;그래서 Python으로 만들어진 EXE를 뜯어보는 방법을 조사하다가 좋은 글&lt;sup class=&quot;footnote-ref&quot; id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;을 발견했습니다.
이 글의 내용을 간단하게 요약하면&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Python 스크립트를 EXE로 만드는 툴로는 &lt;a href=&quot;http://www.py2exe.org/&quot;&gt;py2exe&lt;/a&gt;와 &lt;a href=&quot;https://www.pyinstaller.org/&quot;&gt;PyInstaller&lt;/a&gt;가 널리 쓰인다.&lt;/li&gt;
&lt;li&gt;두 종류 다 대응하는 Awesome한 script를 GitHub에 올려두었으니 사용해라.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;그래서, 감사히 사용해보기로 했습니다.&lt;/p&gt;
&lt;h3&gt;설치&lt;/h3&gt;
&lt;p&gt;아주 당연한 이야기지만 Python이 필요합니다.
하지만 Python 3.7에서는 잘 안되므로 주의가 필요합니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git clone https://github.com/countercept/python-exe-unpacker.git
$ &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; python-exe-unpacker
$ pip install -r requirements.txt
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;준비&lt;/h3&gt;
&lt;p&gt;경로를 길게 입력하는건 취미가 아니므로 분해할 파일을 현재 디렉토리로 옮겨왔습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ cp path/of/program.exe ./program.exe
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;분해&lt;/h3&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ python python_exe_unpack.py -i program.exe
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; On Python &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;.6
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Processing program.exe
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Pyinstaller version: &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;.1+
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; This exe is packed using pyinstaller
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Unpacking the binary now
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Python version: &lt;span class=&quot;m&quot;&gt;36&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Length of package: &lt;span class=&quot;m&quot;&gt;7627814&lt;/span&gt; bytes
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Found &lt;span class=&quot;m&quot;&gt;931&lt;/span&gt; files in CArchive
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Beginning extraction...please standby
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Found &lt;span class=&quot;m&quot;&gt;139&lt;/span&gt; files in PYZ archive
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Successfully extracted pyinstaller exe.
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;생각보다 순식간에 분해가 되었습니다.&lt;/p&gt;
&lt;h2&gt;끝이 아니었다&lt;/h2&gt;
&lt;p&gt;분해 결과물을 보기 위해 뒤적여봤지만 정작 제가 원하는 본체가 보이질 않았습니다.
일단 파일명이 &lt;code&gt;tk&lt;/code&gt;라던가 &lt;code&gt;tcl&lt;/code&gt;로 시작하는 파일은 제 관심사가 아닌게 확실해보였습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ rm -rf unpacked/program.exe/tk* unpacked/program.exe/tcl*
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;불필요한 파일을 깡그리 지우고 나니 내용물이 정리가 되었습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;.pyd&lt;/code&gt; 파일&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.zip&lt;/code&gt; 파일 - 압축을 풀면 Python 기본 라이브러리의 &lt;code&gt;.py&lt;/code&gt; 파일들이 들어있습니다.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.dll&lt;/code&gt; 파일 - Python이나 VC 관련이므로 볼 필요가 없을게 자명했습니다.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;out00-PYZ.pyz_extracted&lt;/code&gt; 디렉토리 - 안에는 Python 기본 라이브러리의 &lt;code&gt;.pyc&lt;/code&gt; 파일들이 들어있습니다.&lt;/li&gt;
&lt;li&gt;메인 로직이 담긴 파일 (확장자가 없다)&lt;/li&gt;
&lt;li&gt;기타 정체를 알 수 없는 확장자 없는 파일들&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;GitHub README에서는 &lt;code&gt;.pyc&lt;/code&gt; 파일을 이용해서 나머지 파일들을 해독할 수 있다고 적혀있었지만, 문서에 적힌 명령어로는 해독이 되질 않았습니다.&lt;/p&gt;
&lt;h2&gt;Python magic numbers&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;.pyc&lt;/code&gt; 파일을 읽을 수 있는 형태로 되돌리려면 Python magic number라는 값이 필요했습니다.
이것이 남아있는 파일은 uncompyle6을 이용해서 내용을 볼 수 있지만, 그렇지 않은 파일은 볼 수 없는 것이죠.
PyInstaller는 아무래도 main파일에서 magic number를 없애버리는 모양이었습니다.
하지만 분해 결과에는 magic number가 남아있는 &lt;code&gt;.pyc&lt;/code&gt; 파일이 많이 있었죠.
uncompyle6로 열어볼 수 있는 파일들의 시작부분과 메인 로직의 시작부분을 대조해보니 다른 점이 보였습니다.&lt;sup class=&quot;footnote-ref&quot; id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;해독이 되는 파일: &lt;code&gt;330d 0d0a 0000 0000 0000 0000 3f00&lt;/code&gt; 로 시작한다&lt;/li&gt;
&lt;li&gt;해독이 안 되는 파일: &lt;code&gt;3f00&lt;/code&gt; 로 시작한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;즉, 제게 필요한 magic number 값은 &lt;code&gt;330d 0d0a 0000 0000 0000 0000&lt;/code&gt; 이었습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;\x33\x0d\x0d\x0a\x00\x00\x00\x00\x00\x00\x00\x00&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cat - unpacked/program.exe/1.1Ver &amp;gt; main.pyc
$ uncompyle6 main.pyc &amp;gt; main.py
$ cat main.py
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;열렸다!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2018-11-04/Extract-Python-Code-from-PyInstaller-EXE-File/result.png&quot; alt=&quot;결과물&quot;&gt;&lt;/p&gt;
&lt;h2&gt;뒷 이야기&lt;/h2&gt;
&lt;p&gt;그렇게 풀린 결과를 열심히 읽어서 결국 원하는 공식을 추출해내는데 성공했지만 생각보다 함정이 많았습니다.
리버스 엔지니어링과는 연이 없는 저였기에 모든 과정이 어려웠지만 가장 당혹스러웠던것은 가장 마지막 결과물이었습니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2018-11-04/Extract-Python-Code-from-PyInstaller-EXE-File/dis.png&quot; alt=&quot;Python이지만 Python이 아닌&quot;&gt;&lt;/p&gt;
&lt;p&gt;일부 코드는 코드로 반환되지 않고 저런 형태로 출력되더군요.
이것은 Python의 내장모듈인 &lt;a href=&quot;https://docs.python.org/3/library/dis.html&quot;&gt;dis&lt;/a&gt;를 사용하면 나오는 코드입니다.
제 경우에는 생각보다 읽을만(?) 했던지라 수작업으로 해독했습니다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;&lt;li id=&quot;fn-1&quot;&gt;&lt;p&gt;&lt;a href=&quot;https://www.countercept.com/blog/how-to-decompile-any-python-binary/&quot;&gt;https://www.countercept.com/blog/how-to-decompile-any-python-binary/&lt;/a&gt;&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;&lt;p&gt;vim으로 열어서 &lt;code&gt;:%!xxd&lt;/code&gt; 모드 사용&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</content>
  </entry>
  <entry xml:base="https://item4.github.io/2018-10-24/Stop-Ask-Passphrase-of-SSH-Key-in-macOS/">
    <title type="text">macOS에서 SSH Key 암호를 그만 요구 당하기</title>
    <id>urn:uuid:4a2e9845-3a27-35ac-9100-86bb93f57705</id>
    <updated>2018-10-24T20:43:00+09:00</updated>
    <link href="https://item4.github.io/2018-10-24/Stop-Ask-Passphrase-of-SSH-Key-in-macOS/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;p&gt;2016년 12월 15일, 저는 macOS를 Sierra로 버전업 한 뒤로 계속 요구되던 SSH Key 암호 입력에 질려서 사투를 하고 고치는 방법을 포스팅했습니다.&lt;sup class=&quot;footnote-ref&quot; id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;
그로부터 약 2년이 지난 오늘, 문득 생각이 났습니다.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;이제 &lt;code&gt;ssh-add -K&lt;/code&gt; 필요 없지 않을까?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;용감(?)하게 rc 파일에서 해당 부분을 주석치고 난 뒤 로그오프 후 재접속을 해보았습니다.
하지만 SSH는 당연하다는듯 제게 또 암호를 물어오더군요.
당시 문제가 되었던건 macOS Sierra, 지금 제 macOS는 Mojave입니다.
OS버전이 상당히 올라갔는데도 이러는게 너무나도 이상하게 보였고, 다시 자료 조사를 시작했습니다.&lt;/p&gt;
&lt;h2&gt;해결법&lt;/h2&gt;
&lt;p&gt;자신의 &lt;strong&gt;macOS 버전이 10.12.2 이상&lt;/strong&gt;이라면 파일 수정 한 번에 고쳐집니다.
&lt;code&gt;~/.ssh/config&lt;/code&gt; 파일의 &lt;strong&gt;맨 마지막줄에&lt;/strong&gt; 다음 설정을 추가합니다.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Host *
    UseKeychain yes
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;이렇게 작업한 뒤 SSH를 사용해보시면 &lt;em&gt;처음 한 번&lt;/em&gt;은 비밀번호를 묻는 prompt가 나올 수 있지만 그 뒤로는 keychain을 사용하여 비밀번호를 묻지 않습니다.
다음 구문으로 GitHub에 SSH Key 테스트를 해보면 확실합니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; ssh git@github.com
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;참고자료&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://superuser.com/questions/1127067/macos-keeps-asking-my-ssh-passphrase-since-i-updated-to-sierra&quot;&gt;macOS keeps asking my ssh passphrase since I updated to Sierra&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;&lt;li id=&quot;fn-1&quot;&gt;&lt;p&gt;&lt;a href=&quot;/2016-12-15/Fix-macOS-cannot-remember-SSH-keys/&quot;&gt;macOS가 SSH Key를 기억하지 못하는 문제 고치기&lt;/a&gt;&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</content>
  </entry>
  <entry xml:base="https://item4.github.io/2018-10-20/Fetch-Alsong-Lyrics-with-Python/">
    <title type="text">Python으로 알송 가사 추출하기</title>
    <id>urn:uuid:cb9a6b93-e64c-3a8e-a56c-ddc924b64889</id>
    <updated>2018-10-20T13:39:00+09:00</updated>
    <link href="https://item4.github.io/2018-10-20/Fetch-Alsong-Lyrics-with-Python/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;h2&gt;알송&lt;/h2&gt;
&lt;p&gt;알송은 이스트소프트에서 만든 알 시리즈 프로그램 중 하나입니다.
특징으로는 재생하는 음원의 가사를 등록하면 다른 사람도 같이 가사와 함께 감상이 가능하다는 점입니다.
그런데 문득 호기심이 생겼습니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;알송에 등록된 가사를 Python으로 가져다 쓸 수 없을까?&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;고대 자료 발굴&lt;/h2&gt;
&lt;p&gt;일단 가장 먼저 해본것은 구글에 &quot;알송 가사 API&quot; 라고 검색한 것입니다.
그러자 검색결과가 나오는데, 엄청 옛날의 포스팅만 나왔습니다.
가장 최근 자료가 2011년 6월이니 막혀있어도 이상하지 않다고 생각했죠.
그래도 밑져야 본전이라고 생각해서 옛날 포스팅들을 참조해서 API 구조를 추정했습니다.
그렇게 다음과 같은 가정을 얻었습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;알송은 하위호환을 위해 가사 API를 그리 크게 바꾸지 않았을 것이다.&lt;/li&gt;
&lt;li&gt;가사 검색 API(이하 API)는 SOAP 기반으로 동작한다. 하지만 wsdl 파일이 제거되어 있다.&lt;/li&gt;
&lt;li&gt;검색 방식은 크게 두 가지, 하나는 &lt;code&gt;title&lt;/code&gt;과 &lt;code&gt;artist_name&lt;/code&gt;기반의 검색, 또 하나는 음원파일 일부의 md5 해시값을 이용한 검색이다.&lt;/li&gt;
&lt;li&gt;SOAP 기반이므로 요청과 반환값은 모두 XML 포멧일 것이다.&lt;/li&gt;
&lt;li&gt;가사의 각 소절 sync 표현식은 &lt;code&gt;\[(\d{2,}):(\d{2}\.\d{2})\].+?&amp;lt;br&amp;gt;&lt;/code&gt; 형식으로 구성된다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;요청부터 날려보자&lt;/h2&gt;
&lt;p&gt;밑져야 본전이라고 생각해서 요청부터 날려보기로 했습니다.
API 호출 방식은 분명히 SOAP이지만 wsdl도 없는데 잘 될리가 없어보이기도 하고, 검색해서 찾은 자료 모두가 SOAP client를 사용하지 않았으므로 그냥 raw string 다루듯 접근했습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;TEMPLATE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;SOAP-ENV:Envelope&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:SOAP-ENV=&amp;quot;http://www.w3.org/2003/05/soap-envelope&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:SOAP-ENC=&amp;quot;http://www.w3.org/2003/05/soap-encoding&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:xsd=&amp;quot;http://www.w3.org/2001/XMLSchema&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:ns2=&amp;quot;ALSongWebServer/Service1Soap&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:ns1=&amp;quot;ALSongWebServer&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:ns3=&amp;quot;ALSongWebServer/Service1Soap12&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;SOAP-ENV:Body&amp;gt;&amp;lt;ns1:GetResembleLyric2&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;ns1:stQuery&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;ns1:strTitle&amp;gt;{title}&amp;lt;/ns1:strTitle&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;ns1:strArtistName&amp;gt;{artist_name}&amp;lt;/ns1:strArtistName&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;ns1:nCurPage&amp;gt;{page}&amp;lt;/ns1:nCurPage&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/ns1:stQuery&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/ns1:GetResembleLyric2&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/SOAP-ENV:Body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/SOAP-ENV:Envelope&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;http://lyrics.alsong.co.kr/alsongwebservice/service1.asmx&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;resp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TEMPLATE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Catch The Moment&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;artist_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;LiSA&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&amp;#39;content-type&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;application/soap+xml&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;실행해보니까 정말로 &lt;strong&gt;동작합니다!&lt;/strong&gt;
이제 써먹을 수 있게 가공해야겠다고 생각했습니다.&lt;/p&gt;
&lt;h2&gt;예쁘게 만들기&lt;/h2&gt;
&lt;p&gt;XML 결과상태로 그대로 쓰는건 불가능하기에 적절히 가공하기로 했습니다.
편의상 노래 한 곡을 &lt;code&gt;Song&lt;/code&gt;이라고 정의하고, 각각의 검색 결과를 &lt;code&gt;Record&lt;/code&gt;, 그 안에 포함된 가사를 &lt;code&gt;Lyric&lt;/code&gt; 라고 명명하기로 했습니다.&lt;/p&gt;
&lt;p&gt;일단 완성된 코드를 붙여넣자면 이러합니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;defaultdict&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;datetime&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timedelta&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;typing&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Union&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;attr&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;inflection&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;lxml.etree&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fromstring&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;timing_pattern&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;\[(\d+):(\d+\.\d+)\](.*)&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_tag_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inflection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;underscore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;{ALSongWebServer}&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;str_&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Lyric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timedelta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;defaultdict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;chunks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;br&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chunk&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chunks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timing_pattern&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;minutes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timedelta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minutes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minutes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;


&lt;span class=&quot;nd&quot;&gt;@attr.dataclass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;slots&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Record&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;artist_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;album_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;register_first_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;register_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;info_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;only_lyric_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;register_first_e_mail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;register_first_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;register_first_phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;register_first_comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;register_e_mail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;register_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;register_phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;register_comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lyric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Union&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Lyric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;converter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Lyric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;make_record&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;el&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Record&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;kw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_tag_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;el&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Record&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;TEMPLATE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&amp;quot;http://www.w3.org/2003/05/soap-envelope&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:SOAP-ENC=&amp;quot;http://www.w3.org/2003/05/soap-encoding&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:xsd=&amp;quot;http://www.w3.org/2001/XMLSchema&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:ns2=&amp;quot;ALSongWebServer/Service1Soap&amp;quot; xmlns:ns1=&amp;quot;ALSongWebServer&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;xmlns:ns3=&amp;quot;ALSongWebServer/Service1Soap12&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;SOAP-ENV:Body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;ns1:GetResembleLyric2&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;ns1:stQuery&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;ns1:strTitle&amp;gt;{title}&amp;lt;/ns1:strTitle&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;ns1:strArtistName&amp;gt;{artist}&amp;lt;/ns1:strArtistName&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;ns1:nCurPage&amp;gt;{page}&amp;lt;/ns1:nCurPage&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/ns1:stQuery&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/ns1:GetResembleLyric2&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/SOAP-ENV:Body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/SOAP-ENV:Envelope&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Song&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;records&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Record&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;records&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;records&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@classmethod&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;from_title_and_artist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;artist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;resp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;s1&quot;&gt;&amp;#39;http://lyrics.alsong.co.kr/alsongwebservice/service1.asmx&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TEMPLATE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;artist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;artist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;application/soap+xml&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fromstring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make_record&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;el&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;el&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;song&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Song&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_title_and_artist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Catch the moment&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;LiSA&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;song&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;records&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;참고로 실제 실행해보려면 외부 의존성 &lt;code&gt;attrs&lt;/code&gt;, &lt;code&gt;inflection&lt;/code&gt;, &lt;code&gt;lxml&lt;/code&gt;, &lt;code&gt;requests&lt;/code&gt; 를 설치하셔야 합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Song 개체는 classmethod로 생성합니다. 사실 mp3을 기준으로 검색하는 버전도 만들어보고 싶었는데 귀찮아져서(...) 현재 구조가 되었습니다.&lt;/li&gt;
&lt;li&gt;검색결과는 lxml을 이용하여 파싱합니다. XML값을 처리하는 도구중에 가장 손에 익은것이 lxml이었기 때문에 채택했습니다.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;make_record&lt;/code&gt; 함수를 만들었습니다. 해당 함수에 넣으면 camelCase인 tag name을 underscore로 전환하고, 적절히 가공하여 &lt;code&gt;Record&lt;/code&gt; class의 생성자 재료로 변환하여 줍니다.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Record&lt;/code&gt; class는 attrs 패키지를 이용해서 구현했습니다. 그냥 만들려고 했다간 생성자가 너무 복잡해지기 때문입니다. Python 내장의 dataclasses를 쓴다는 선택지도 있었지만 slot 기능을 지원하는 attrs를 골랐습니다.&lt;/li&gt;
&lt;li&gt;가장 중요한 가사는 &lt;code&gt;&amp;lt;br&amp;gt;&lt;/code&gt; 기준으로 줄을 나눈 다음, 시간 마커와 가사를 분리해서 저장했습니다. 가령 같은 시간에 3개의 가사가 동시에 나오는 경우 같은 시간 마커를 가지는 line이 3개가 됩니다. 이를 유연하게 저장하기 위해 시간마커를 &lt;code&gt;key&lt;/code&gt;로 하는 &lt;code&gt;list&lt;/code&gt;의 &lt;code&gt;dict&lt;/code&gt;를 만들었습니다. 몇 줄이 와도 자동으로 처리가 되도록 만들고 싶었습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;주물주물 1 - 싱크 손상 감지&lt;/h2&gt;
&lt;p&gt;알송에서 가사를 보다보면 가끔씩 가사가 출력되다가 노래는 아직 끝나지 않았는데 가사만 혼자 끝으로 날아가는 경우가 있습니다.
이런 상태를 감지하는 기능을 만들어보기로 했습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;warnings&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Lyric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timedelta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;defaultdict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;last_pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timedelta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;chunks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;br&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chunk&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chunks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timing_pattern&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;minutes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timedelta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minutes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minutes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;last_pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;
                    &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;warnings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;warn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;손상된 Sync가 있어 무시하고 진행합니다.&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;ne&quot;&gt;RuntimeWarning&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;실제로 &lt;code&gt;Song.from_title_and_artist('それは小さな光のような', 'さユり')&lt;/code&gt;를 실행하면 해당 Warning이 나오는 것을 확인할 수 있습니다.&lt;/p&gt;
&lt;h2&gt;주물주물 2 - smi 자막으로 저장하기&lt;/h2&gt;
&lt;p&gt;해당 가사를 다른 미디어 재생기에서 보기 위해서는 smi 자막으로 전환할 필요가 있습니다.
smi 포멧 또한 XML 포멧이긴 하지만, 너무나도 변칙적인 요소가 많은 관계로 정석적인 XML 생성보다는 그냥 문자열 생성이 낫다고 판단하여 작업해보았습니다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Lyric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# 생략&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;to_sami&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;timeline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;SYNC Start={}&amp;gt;&amp;lt;P Class=KRCC&amp;gt;{}&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;total_seconds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;br&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeline&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Record&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# 생략&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;save_as_sami&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_sami&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;to_sami&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;HEAD&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;TITLE&amp;gt;{self.artist_name} - {self.title}&amp;lt;/TITLE&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;STYLE TYPE=&amp;quot;text/css&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;!--&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;P {margin-left:8pt; margin-right:8pt; margin-bottom:2pt; margin-top:2pt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;  text-align:center; font-size:20pt; font-family:sans-serif;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;  font-weight:normal; color:White;}&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;.KRCC {Name:한국어; lang:kr-KR; SAMIType:CC;}&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/STYLE&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/HEAD&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;BODY&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;!--&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;아티스트: {self.artist_name}&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;제목: {self.title}&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;앨범: {self.album_name}&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lyric&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_sami&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/BODY&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;lt;/SAMI&amp;gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# 생략&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;song&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Song&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_title_and_artist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;それは小さな光のような&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;さユり&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;song&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;records&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save_as_sami&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;test.smi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;실제로 &lt;code&gt;test.smi&lt;/code&gt;파일이 생성됨을 확인할 수 있습니다.&lt;/p&gt;
&lt;h2&gt;더 해보고 싶었지만 하지 않은것&lt;/h2&gt;
&lt;h3&gt;1. MP3 파일을 기준으로 가사 검색하기&lt;/h3&gt;
&lt;p&gt;곡의 제목이나 아티스트를 제대로 알 수 없는 경우, MP3 기준으로 가사를 검색하려면 해당 파일을 열어서 ID3 부분을 모두 무시하고 실제 음원 부분에서 163840 바이트를 읽어서 md5로 hexdigest하면 됩니다.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;SOAP-ENV:Envelope
xmlns:SOAP-ENV=&quot;http://www.w3.org/2003/05/soap-envelope&quot;
xmlns:SOAP-ENC=&quot;http://www.w3.org/2003/05/soap-encoding&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;
xmlns:ns2=&quot;ALSongWebServer/Service1Soap&quot;
xmlns:ns1=&quot;ALSongWebServer&quot;
xmlns:ns3=&quot;ALSongWebServer/Service1Soap12&quot;&amp;gt;
&amp;lt;SOAP-ENV:Body&amp;gt;
&amp;lt;ns1:GetLyric5&amp;gt;
&amp;lt;ns1:stQuery&amp;gt;
&amp;lt;ns1:strChecksum&amp;gt;{hash}&amp;lt;/ns1:strChecksum&amp;gt;
&amp;lt;ns1:strVersion&amp;gt;2.0 beta2&amp;lt;/ns1:strVersion&amp;gt;
&amp;lt;ns1:strMACAddress&amp;gt;ffffffffffff&amp;lt;/ns1:strMACAddress&amp;gt;
&amp;lt;ns1:strIPAddress&amp;gt;255.255.255.0&amp;lt;/ns1:strIPAddress&amp;gt;
&amp;lt;/ns1:stQuery&amp;gt;
&amp;lt;/ns1:GetLyric5&amp;gt;
&amp;lt;/SOAP-ENV:Body&amp;gt;
&amp;lt;/SOAP-ENV:Envelope&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;하지만 Python으로 하기에 그리 적합한 작업이라고 생각되지 않는데다가 이상하게 전송하면 서버로부터 차단당할 위험이 있어보이는 필드들(version, mac address, ip address)도 섞여있어서 실제로 손대진 않았습니다.&lt;/p&gt;
&lt;h3&gt;2. SMI 파일을 알송 자막 포멧으로 바꾸기&lt;/h3&gt;
&lt;p&gt;실천하지 않은 이유는 간단합니다.
&lt;strong&gt;SMI 파싱하기 싫어요.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;SMI는 심하게 변칙적이라서 파싱이 쉽지 않습니다.
XML의 양식을 띄고 있음에도 XML 헤더가 없다던가, HTML의 CSS같은 요소가 포함되어 있지만 CSS 표준과는 부합하지 않는다던가 하는 문제들이 산적해 있습니다.
그걸 파싱하겠다고 덤비기는 귀찮아서 손대지 않았습니다.&lt;/p&gt;
&lt;h2&gt;참고자료&lt;/h2&gt;
&lt;p&gt;참고: 모두 오래된 자료들입니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://dialup.egloos.com/152001&quot;&gt;알송의 온라인 가사 서비스를 확인하다.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://mudchobo.tistory.com/443&quot;&gt;[Flex/AIR] MP3파일을 이용해 알송가사서버에서 싱크가사데이터 받기&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://frontjang.tistory.com/199&quot;&gt;알송 가사 읽어오기 [#1 가수+제목]&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
  </entry>
</feed>
